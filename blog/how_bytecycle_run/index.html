<!doctype html><html lang=en-us><head><meta http-equiv=X-Clacks-Overhead content="GNU Terry Pratchett"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" href=https://zerlina-ysl.github.io/img/favicon.png><title>自动化流水线如何构建项目 | ᕕ( ᐛ )ᕗ xiaoli's blog</title>
<meta name=title content="自动化流水线如何构建项目"><meta name=description content="对一次请求的全链路浅研究"><meta name=keywords content="云原生,"><meta property="og:title" content="自动化流水线如何构建项目"><meta property="og:description" content="对一次请求的全链路浅研究"><meta property="og:type" content="article"><meta property="og:url" content="https://zerlina-ysl.github.io/blog/how_bytecycle_run/"><meta property="article:section" content="blog"><meta property="article:published_time" content="2022-11-19T23:15:09+08:00"><meta property="article:modified_time" content="2022-11-18T23:15:09+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="自动化流水线如何构建项目"><meta name=twitter:description content="对一次请求的全链路浅研究"><meta itemprop=name content="自动化流水线如何构建项目"><meta itemprop=description content="对一次请求的全链路浅研究"><meta itemprop=datePublished content="2022-11-19T23:15:09+08:00"><meta itemprop=dateModified content="2022-11-18T23:15:09+08:00"><meta itemprop=wordCount content="39"><meta itemprop=keywords content="云原生,"><meta name=referrer content="no-referrer-when-downgrade"><style>body{font-family:Verdana,sans-serif;margin:auto;padding:20px;max-width:720px;text-align:left;background-color:#fff;word-wrap:break-word;overflow-wrap:break-word;line-height:1.5;color:#444}h1,h2,h3,h4,h5,h6,strong,b{color:#222}a{color:#3273dc}.title{text-decoration:none;border:0}.title span{font-weight:400}nav a{margin-right:10px}textarea{width:100%;font-size:16px}input{font-size:16px}content{line-height:1.6}table{width:100%}img{max-width:100%}code{padding:2px 5px;background-color:#f2f2f2}pre code{color:#222;display:block;padding:20px;white-space:pre-wrap;font-size:14px;overflow-x:auto}div.highlight pre{background-color:initial;color:initial}div.highlight code{background-color:unset;color:unset}blockquote{border-left:1px solid #999;color:#222;padding-left:20px;font-style:italic}footer{padding:25px;text-align:center}.helptext{color:#777;font-size:small}.errorlist{color:#eba613;font-size:small}ul.blog-posts{list-style-type:none;padding:unset}ul.blog-posts li{display:flex}ul.blog-posts li span{flex:0 0 130px}ul.blog-posts li a:visited{color:#8b6fcb}@media(prefers-color-scheme:dark){body{background-color:#333;color:#ddd}h1,h2,h3,h4,h5,h6,strong,b{color:#eee}a{color:#8cc2dd}code{background-color:#777}pre code{color:#ddd}blockquote{color:#ccc}textarea,input{background-color:#252525;color:#ddd}.helptext{color:#aaa}}</style></head><body><header><a href=/ class=title><h2>ᕕ( ᐛ )ᕗ xiaoli's blog</h2></a><nav><a href=/>Home</a>
<a href=/diary/>Diary</a>
<a href=/blog>Blog</a></nav></header><main><h1>自动化流水线如何构建项目</h1><p><i><time datetime=2022-11-19 pubdate>19 Nov, 2022</time></i></p><content><p>自动化流水线如何构建项目并运行？<br>DevOps（Development和Operations的组合词）是一种重视“软件开发人员（Dev）”和“IT运维技术人员（Ops）”之间沟通合作的文化、运动或惯例。透过自动化“软件交付”和“架构变更”的流程，来使得构建、测试、发布软件能够更加地快捷、频繁和可靠。</p><h2 id=sourcecontrolmanagement-代码发布管理平台>SourceControlManagement 代码发布管理平台</h2><p>拉取源代码，运行指定的build脚本(如 <code>sh build.sh</code>），将打包后的output目录下的内容打包成tar包并上传，生成可以在线上运行的代码或资源。</p><h2 id=cloudengine云引擎>CloudEngine云引擎</h2><p>容器发布和管理平台，基于k8s。 到scm仓库拉取tar的压缩包，根据配置生成用于构建的dockerFile，构建docker镜像,挂在宿主机上，启动服务，为服务创建唯一标识（psm)进行后续的管理。部署时通过k8s调度到某个node的pod，下载服务镜像。<br>TCE将一些物理服务器资源合并成一个集群，再将集群拆分为更细粒度的计算资源，从而实现对计算资源更灵活的调度和分配。<br>集群中多实例部署，每个实例只需要负责一部分的请求流量。多实例也可以实现容灾和滚动升级。<br>可以通过实例 ip+port的方法访问所部署的服务，也可以使用psm，即每个实例启动，会向注册中心报告自己的psm和ip，这样下游服务就可以访问注册中心来获得对应psm的实例列表。<br><img src=image.png alt></p><h2 id=apimanament>ApiManament</h2><p>管理服务接口,集成了测试、抓包、mock测试等功能。</p><h2 id=apigeteway>ApiGeteWay</h2><p>以API为核心，提供流量调度、限流、降级、服务治理等全套解决方案能力的网关平台。 AGW将http协议转换为thrift协议，把http请求转换为kitex请求。所以也需要在idl文件中根据idl语法进行标注。</p><h3 id=分布式agw>分布式AGW</h3><p>网关以独立的进程部署在业务实例中，流量->TLB->业务集群，通过网关转发到业务实例。流量路径中少一跳，整体时延收益明显。同时，分布式网关以sidecar模式独立进程部署在业务实例中，业务PSM天然隔离，隔离性和稳定性更好。 分布式AGW不支持跨机房流量调度、分流能力，比较依赖tlb的分流能力；不支持请求合并。</p><h3 id=中心化agw>中心化AGW</h3><p>流量路径从TLB–>网关集群–>业务集群。优势在于AGW集群作为集中到网关节点，拥有灵活的流量调度能力，如集群分流、机房调度等。<br>网关逻辑的更改发布一旦有问题，会影响所有业务。</p><p>从网关能力演进的角度来看，分布式网关是未来的趋势。API Gateway Mesh逐渐成为主流。</p><h2 id=loadbalance>LoadBalance</h2><p>管理服务域名流量入口的七层负载均衡服务。<br>用户可以在TLB平台为自己的服务配置对外的域名从而完成流量接入。支持对域名进行匹配，如正则匹配、自定义匹配等，将访问域名的流量通过不同路由分发到对应的后端psm服务。</p><h2 id=参考>参考</h2><p>相爱相杀：Servicemesh和API Gateway关系深度探讨：https://skyao.io/post/202004-servicemesh-and-api-gateway/<br>蚂蚁金服 API Gateway Mesh 思考与实践：https://www.infoq.cn/article/azCFGyTDGakZqaLEEDMN</p></content><p><a href=https://zerlina-ysl.github.io/tags/%E4%BA%91%E5%8E%9F%E7%94%9F/>#云原生</a></p></main><footer>Made with <a href=https://github.com/janraasch/hugo-bearblog/>Hugo ʕ•ᴥ•ʔ Bear</a></footer></body></html>